<xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">	<xsl:output omit-xml-declaration="yes" indent="yes" />	<xsl:template match="event">		<div class="event">			<xsl:copy-of select="message/child::node()" />		</div>	</xsl:template>	<xsl:template match="envelope">		<xsl:variable name="envelopeClass">			<xsl:choose>				<xsl:when test="message/@highlight = 'yes'">					<xsl:text>envelopeHighlight</xsl:text>				</xsl:when>				<xsl:otherwise>					<xsl:text>envelope</xsl:text>				</xsl:otherwise>			</xsl:choose>		</xsl:variable>		<xsl:variable name="senderClass">			<xsl:choose>				<xsl:when test="sender/@self = 'yes'">					<xsl:text>senderSelf</xsl:text>				</xsl:when>				<xsl:otherwise>					<xsl:text>sender</xsl:text>				</xsl:otherwise>			</xsl:choose>		</xsl:variable>		<div id="{@id}" class="{$envelopeClass}">			<xsl:choose>				<xsl:when test="contains(message, ',')">					<q lang="en">						<span class="message"><xsl:value-of select="normalize-space(substring-before( message, ',' ))" /></span>						<xsl:text>,</xsl:text>					</q>					<xsl:text> </xsl:text>					<span class="{$senderClass}"><xsl:value-of select="sender" /></span>					<xsl:text> says </xsl:text>					<q lang="en">						<span class="message"><xsl:value-of select="normalize-space(substring-after( message, ',' ))" /></span>					</q>				</xsl:when>				<xsl:otherwise>					<q lang="en">						<span class="message"><xsl:value-of select="normalize-space(message)" /></span>						<xsl:text>,</xsl:text>					</q>					<xsl:text> said </xsl:text>					<span class="{$senderClass}"><xsl:value-of select="sender" /></span>				</xsl:otherwise>			</xsl:choose>		</div>	</xsl:template></xsl:transform>